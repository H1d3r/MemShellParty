plugins {
    id 'java'
    id 'idea'
    id 'jacoco'
}

repositories {
    mavenCentral()
}

idea {
    module {
        excludeDirs -= file('build')
    }
}

jacocoTestReport {
    reports {
        xml.required = true
        csv.required = true
        html.required = true
    }
    afterEvaluate {
        executionData.from fileTree(rootDir) {
            include '**/build/jacoco/*.exec'
        }

        sourceDirectories = files('generator/src/main/java')

        classDirectories.from(
                fileTree('generator/build/classes/java/main') {
                    excludes = [
                            'com/reajason/javaweb/memsell/**/godzilla/**',
                            'com/reajason/javaweb/memsell/**/injector/**',
                            'com/reajason/javaweb/memsell/**/command/**',
                            'com/reajason/javaweb/config/**'
                    ]
                }
        )
    }
}